{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/linchian/Documents/GitHub/next-minmax/src/features/language/presentation/hooks/useLanguages.ts"],"sourcesContent":["// src/features/language/presentation/hooks/useLanguages.ts\n'use client';\n\nimport type { Language } from '@/types';\nimport { useLanguageContext } from '../LanguageProvider';\n\nexport function useLanguages(): Language[] {\n    return useLanguageContext().languages;\n}"],"names":[],"mappings":"AAAA,2DAA2D;;;;AAI3D;;AAHA;;AAKO,SAAS;;IACZ,OAAO,CAAA,GAAA,mKAAA,CAAA,qBAAkB,AAAD,IAAI,SAAS;AACzC;GAFgB;;QACL,mKAAA,CAAA,qBAAkB","debugId":null}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///Users/linchian/Documents/GitHub/next-minmax/src/features/language/presentation/components/LanguageSwitcher.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport Image from 'next/image';\nimport { useRouter, usePathname, useSearchParams } from 'next/navigation';\nimport type { Language } from '@/types/language';\nimport { useLanguages } from '../hooks/useLanguages';\n\ntype LanguageSwitcherProps = {\n    className?: string;\n};\n\n/**\n * 自帶導頁的語系切換元件\n * - 內部處理 router 導頁與 NEXT_LOCALE cookie\n * - 不再接受 onSelect（避免從 Server Component 傳 function 的限制）\n *\n * 導頁策略（簡化版）：\n * 1) 嘗試從目前 pathname 的第一段判斷是否為語系代碼（在支援清單中）\n * 2) 切換為「非預設語系」→ 以 /{locale}/{rest} 形式導頁\n * 3) 切換為「預設語系」→ 去除路由前綴，導向 /{rest}\n * 4) 保留現有查詢參數（?query）\n */\nexport default function LanguageSwitcher({ className }: LanguageSwitcherProps) {\n    const languages = useLanguages();\n    const router = useRouter();\n    const pathname = usePathname() || '/';\n    const searchParams = useSearchParams();\n\n    if (!languages || languages.length === 0) {\n        return null;\n    }\n\n    const localeIds = React.useMemo(\n        () => new Set(languages.map((l) => l.id)),\n        [languages]\n    );\n\n    function buildNextPath(target: Language): string {\n        const raw = pathname;\n        const parts = raw.split('/').filter(Boolean); // 去掉空白段\n        const first = parts[0];\n\n        // 判斷目前路由是否含有語系前綴\n        const hasLocalePrefix = !!first && localeIds.has(first);\n        const restPath =\n            hasLocalePrefix ? `/${parts.slice(1).join('/')}` : raw;\n\n        // 預設語系：不加前綴；非預設語系：加上 /{locale}\n        const nextBase =\n            target.default ? restPath || '/' : `/${target.id}${restPath === '/' ? '' : restPath}`;\n\n        // 保留查詢參數\n        const qs = searchParams?.toString();\n        return qs ? `${nextBase}?${qs}` : nextBase;\n    }\n\n    function selectLanguage(target: Language) {\n        // 寫入 next-intl 兼容的 cookie\n        // 180 天有效期；如有自定網域請附加 domain 與 secure 屬性\n        document.cookie = `NEXT_LOCALE=${encodeURIComponent(\n            target.id\n        )}; path=/; max-age=${60 * 60 * 24 * 180}`;\n\n        const nextPath = buildNextPath(target);\n        router.push(nextPath, { scroll: false });\n    }\n\n    return (\n        <nav className={className} aria-label=\"Language switcher\">\n            <ul className=\"flex flex-wrap items-center gap-2\">\n                {languages.map((lang) => {\n                    const label = lang.native || lang.title;\n                    return (\n                        <li key={lang.id}>\n                            <button\n                                type=\"button\"\n                                onClick={() => selectLanguage(lang)}\n                                className={\n                                    'inline-flex items-center gap-2 rounded px-3 py-1 text-sm ' +\n                                    (lang.default\n                                        ? 'bg-blue-600 text-white'\n                                        : 'bg-gray-100 text-gray-800 hover:bg-gray-200')\n                                }\n                                aria-current={lang.default ? 'true' : undefined}\n                                title={lang.title}\n                            >\n                                {lang.icon ? (\n                                    <Image\n                                        src={lang.icon}\n                                        alt={label}\n                                        width={16}\n                                        height={16}\n                                        className=\"h-4 w-4 rounded-sm object-cover\"\n                                    />\n                                ) : null}\n                                <span>{label}</span>\n                                {lang.default ? (\n                                    <span className=\"ml-1 rounded bg-blue-500/20 px-1.5 py-0.5 text-[10px]\">\n                    default\n                  </span>\n                                ) : null}\n                            </button>\n                        </li>\n                    );\n                })}\n            </ul>\n        </nav>\n    );\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;;;AANA;;;;;AAuBe,SAAS,iBAAiB,KAAoC;QAApC,EAAE,SAAS,EAAyB,GAApC;;IACrC,MAAM,YAAY,CAAA,GAAA,uKAAA,CAAA,eAAY,AAAD;IAC7B,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD,OAAO;IAClC,MAAM,eAAe,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;IAEnC,IAAI,CAAC,aAAa,UAAU,MAAM,KAAK,GAAG;QACtC,OAAO;IACX;IAEA,MAAM,YAAY,6JAAA,CAAA,UAAK,CAAC,OAAO;+CAC3B,IAAM,IAAI,IAAI,UAAU,GAAG;uDAAC,CAAC,IAAM,EAAE,EAAE;;8CACvC;QAAC;KAAU;IAGf,SAAS,cAAc,MAAgB;QACnC,MAAM,MAAM;QACZ,MAAM,QAAQ,IAAI,KAAK,CAAC,KAAK,MAAM,CAAC,UAAU,QAAQ;QACtD,MAAM,QAAQ,KAAK,CAAC,EAAE;QAEtB,iBAAiB;QACjB,MAAM,kBAAkB,CAAC,CAAC,SAAS,UAAU,GAAG,CAAC;QACjD,MAAM,WACF,kBAAkB,AAAC,IAA4B,OAAzB,MAAM,KAAK,CAAC,GAAG,IAAI,CAAC,QAAS;QAEvD,+BAA+B;QAC/B,MAAM,WACF,OAAO,OAAO,GAAG,YAAY,MAAM,AAAC,IAAe,OAAZ,OAAO,EAAE,EAAoC,OAAjC,aAAa,MAAM,KAAK;QAE/E,SAAS;QACT,MAAM,KAAK,yBAAA,mCAAA,aAAc,QAAQ;QACjC,OAAO,KAAK,AAAC,GAAc,OAAZ,UAAS,KAAM,OAAH,MAAO;IACtC;IAEA,SAAS,eAAe,MAAgB;QACpC,0BAA0B;QAC1B,wCAAwC;QACxC,SAAS,MAAM,GAAG,AAAC,eAEG,OAFW,mBAC7B,OAAO,EAAE,GACX,sBAAuC,OAAnB,KAAK,KAAK,KAAK;QAErC,MAAM,WAAW,cAAc;QAC/B,OAAO,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAM;IAC1C;IAEA,qBACI,6LAAC;QAAI,WAAW;QAAW,cAAW;kBAClC,cAAA,6LAAC;YAAG,WAAU;sBACT,UAAU,GAAG,CAAC,CAAC;gBACZ,MAAM,QAAQ,KAAK,MAAM,IAAI,KAAK,KAAK;gBACvC,qBACI,6LAAC;8BACG,cAAA,6LAAC;wBACG,MAAK;wBACL,SAAS,IAAM,eAAe;wBAC9B,WACI,8DACA,CAAC,KAAK,OAAO,GACP,2BACA,6CAA6C;wBAEvD,gBAAc,KAAK,OAAO,GAAG,SAAS;wBACtC,OAAO,KAAK,KAAK;;4BAEhB,KAAK,IAAI,iBACN,6LAAC,gIAAA,CAAA,UAAK;gCACF,KAAK,KAAK,IAAI;gCACd,KAAK;gCACL,OAAO;gCACP,QAAQ;gCACR,WAAU;;;;;uCAEd;0CACJ,6LAAC;0CAAM;;;;;;4BACN,KAAK,OAAO,iBACT,6LAAC;gCAAK,WAAU;0CAAwD;;;;;uCAGxE;;;;;;;mBA3BH,KAAK,EAAE;;;;;YA+BxB;;;;;;;;;;;AAIhB;GAtFwB;;QACF,uKAAA,CAAA,eAAY;QACf,qIAAA,CAAA,YAAS;QACP,qIAAA,CAAA,cAAW;QACP,qIAAA,CAAA,kBAAe;;;KAJhB","debugId":null}}]
}